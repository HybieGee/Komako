---
import BaseLayout from '@layouts/BaseLayout.astro';
import AlbumCard from '@components/AlbumCard.astro';
import { getAlbums, getPhotos } from '@lib/content';
import { useTranslations } from '@lib/i18n';

const lang = 'ja';
const t = useTranslations(lang);

const albums = await getAlbums(lang);
const photos = await getPhotos(lang);

const albumsWithCount = albums.map(album => ({
  ...album,
  photoCount: photos.filter(photo => photo.album === album.slug).length,
}));
---

<BaseLayout
  title={`${t('albums.title')} - コマコギャラリー`}
  description={t('albums.subtitle')}
  lang={lang}
>
  <div class="container py-8">
    <header class="mb-8">
      <h1 class="text-3xl font-bold">{t('albums.title')}</h1>
      <p class="mt-2 text-komako-soft">
        {t('albums.subtitle')}
      </p>
    </header>
    
    {albumsWithCount.length > 0 ? (
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {albumsWithCount.map((album) => (
          <AlbumCard {...album} />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-komako-soft">現在利用可能なアルバムがありません。</p>
      </div>
    )}
  </div>
</BaseLayout>